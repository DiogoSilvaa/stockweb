{% load static %}
 
<!DOCTYPE html>
<html>
    <head>
        <title>{% block title %}Stock's Crystall Ball{% endblock %}</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css" />
        <!-- Third party plugin CSS-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="{% static 'theme/css/styles.css' %}" rel="stylesheet" />
        <!-- Plotly graph -->
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        
    </head>
    <body>
        {% include 'navbar.html' %}
        <main>
         {% block content%}
         
         {% endblock %}
         <!-- Footer-->
        <footer class="bg-black py-5">
            <div class="container">
                <div class="small text-center text-muted">
                    Stocknetics &copy;
                    <!-- This script automatically adds the current year to your website footer-->
                    <!-- (credit: https://updateyourfooter.com/)-->
                    <script>
                        document.write(new Date().getFullYear());
                    </script>
                    -See the future, trade today.
                </div>
            </div>
        </footer>
        </main>
            <!-- Bootstrap core JS-->
            <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
            <!-- Third party plugin JS-->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
            <!-- Core theme JS-->
            <script src="{% static 'theme/js/scripts.js' %}"></script>
            <!-- Get data from Alphavantage -->
            <script>
                
                var endpointNQ = "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=QQQ&outputsize=full&apikey=RE1L9V2O9V5IUAQJ";
                var endpointDW = "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=DIA&outputsize=full&apikey=RE1L9V2O9V5IUAQJ";
                var endpointSP = "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=SPY&outputsize=full&apikey=RE1L9V2O9V5IUAQJ";
                var endpointNQ_SMA = "https://www.alphavantage.co/query?function=SMA&symbol=QQQ&interval=daily&time_period=150&series_type=close&apikey=RE1L9V2O9V5IUAQJ";
                var endpointDW_SMA = "https://www.alphavantage.co/query?function=SMA&symbol=DIA&interval=daily&time_period=150&series_type=close&apikey=RE1L9V2O9V5IUAQJ";
                var endpointSP_SMA = "https://www.alphavantage.co/query?function=SMA&symbol=SPY&interval=daily&time_period=150&series_type=close&apikey=RE1L9V2O9V5IUAQJ";
                var nq, sp, dw;
                
                $.ajax({
                    method: "GET",
                    url: endpointSP,
                    success: function(data){
                        sp = data_processing(data);
                    },
                    error: function(error_data){
                        console.log("error");
                        console.log(error_data);
                    },
                });

                $.ajax({
                    method: "GET",
                    url: endpointNQ,
                    success: function(data){
                        nq = data_processing(data);
                    },
                    error: function(error_data){
                        console.log("error");
                        console.log(error_data);
                    },
                });

                $.ajax({
                    method: "GET",
                    url: endpointDW,
                    success: function(data){
                        dw = data_processing(data);
                    },
                    error: function(error_data){
                        console.log("error");
                        console.log(error_data);
                    },
                });

                $.ajax({
                    method: "GET",
                    url: endpointSP_SMA,
                    success: function(data){
                        //sp = data_processing(data);
                    },
                    error: function(error_data){
                        console.log("error");
                        console.log(error_data);
                    },
                });

                $.ajax({
                    method: "GET",
                    url: endpointNQ_SMA,
                    success: function(data){
                        //nq = data_processing(data);
                    },
                    error: function(error_data){
                        console.log("error");
                        console.log(error_data);
                    },
                });

                $.ajax({
                    method: "GET",
                    url: endpointDW_SMA,
                    success: function(data){
                        //dw = data_processing(data);
                    },
                    error: function(error_data){
                        console.log("error");
                        console.log(error_data);
                    },
                });

                function data_processing(obj) {
                    console.log(obj["Time Series (Daily)"][0]);
                }   
            </script>
            <script>
                var SP = document.getElementById('sp-graph');
                var NQ = document.getElementById('nq-graph');
                var DW = document.getElementById('dw-graph');

                var date = ['2018-01-01','2018-01-02','2018-01-03','2018-01-04','2018-01-05'];

                var SPdata = [{
                    type: "scatter",
                    date,
                    y: [1, 2, 4, 8, 16],
                    line: {color: 'green', width: 4, shape: 'spline'}
                }]
                var NQdata = [{
                    date,
                    y: [1, 2, 4, 8, 16],
                    line: {color: 'green', width: 4, shape: 'spline'}
                }]  
                var DWdata = [{
                    date,
                    y: [1, 2, 4, 8, 16],
                    line: {color: 'green', width: 4, shape: 'spline'}
                }]

                Plotly.newPlot( SP, SPdata, {margin: { t: 0 } } );
                Plotly.newPlot( NQ, NQdata, {margin: { t: 0 } } );
                Plotly.newPlot( DW, DWdata, {margin: { t: 0 } } );

            </script>
    </body>
</html>